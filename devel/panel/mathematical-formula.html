

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Formulas and Mathematical Detail &#8212; linearmodels 3.5+15.gd85af6a documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.5+15.gd85af6a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Implementation Choices" href="faq.html" />
    <link rel="prev" title="Panel Data Structures" href="data.html" />
  
  
   

  <link rel="stylesheet" href="../_static/css/overrides.css" type="text/css" />

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Implementation Choices"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="data.html" title="Panel Data Structures"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">linearmodels 3.5+15.gd85af6a documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Panel Data Model Estimation</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
        <a href="
    ../index.html" class="text-logo">linearmodels 3.5 (+15, gd85af6a)</a>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../iv/index.html">Instrumental Variable Estimation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Panel Data Model Estimation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/data-formats.html">Data Formats for Panel Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/using-formulas.html">Using formulas to specify models</a></li>
<li class="toctree-l2"><a class="reference internal" href="pandas.html">Comparison with pandas PanelOLS and FamaMacBeth</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference.html">Module Reference</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Formulas and Mathematical Detail</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html">Implementation Choices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../asset-pricing/index.html">Linear Factor Models for Asset Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system/index.html">System Regression Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utility.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plan.html">Module Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

    
  </div>
</div>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="index.html">Panel Data Model Estimation</a></li>
              
              <li>Formulas and Mathematical Detail</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="formulas-and-mathematical-detail">
<span id="panel-mathematical-notation"></span><h1>Formulas and Mathematical Detail<a class="headerlink" href="#formulas-and-mathematical-detail" title="Permalink to this headline">¶</a></h1>
<div class="section" id="models">
<h2>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h2>
<p>The estimators in this module are designed to estimate the parameters of
a model specified by</p>
<div class="math">
\[y_{it}=x_{it}\beta+\alpha_{i}+\epsilon_{it}\]</div>
<p>where <span class="math">\(i\)</span> indexes entities and <span class="math">\(t\)</span> indexes time,
<span class="math">\(x_{it}\)</span>is <span class="math">\(1\)</span> by <span class="math">\(k\)</span> (may include a constant, but
not for all models), <span class="math">\(\beta\)</span> is <span class="math">\(k\)</span> by 1, <span class="math">\(\alpha_{i}\)</span>
is an entity-specific shock and <span class="math">\(\epsilon_{it}\)</span> is an
idiosyncratic shock. The most important difference in the models is the
assumptions on <span class="math">\(\alpha_{i}\)</span> which determine whether the estimator
is consistent and/or efficient. There are <span class="math">\(N\)</span> entities and
<span class="math">\(T_{i}\)</span> observations for entity <span class="math">\(i\)</span>.</p>
<div class="section" id="fixed-effect-estimation-panelols">
<h3>Fixed Effect Estimation (PanelOLS)<a class="headerlink" href="#fixed-effect-estimation-panelols" title="Permalink to this headline">¶</a></h3>
<p>The fixed effect estimator with entity effects estimates the model</p>
<div class="math">
\[y_{it}-\bar{y}_{i}=(x_{it}-x_{i})\beta+\left(\epsilon_{it}-\bar{\epsilon}_{i}\right).\]</div>
<p>When the model includes a constant in <span class="math">\(x_{it}\)</span> then the grand mean
of <span class="math">\(y\)</span>,
<span class="math">\(\bar{\bar{y}}=(NT)^{-1}\sum_{i=1}^{N}\sum_{t=1}^{T_{i}}y_{it}\)</span>,
and <span class="math">\(x\)</span> are re-added to the <span class="math">\(y\)</span> and <span class="math">\(x\)</span> terms,
respectively. In practice this imposes the restriction that
<span class="math">\(\sum\alpha_{i}=0\)</span>. The estimated coefficients for the remaining
parameters are identical as is the estimated parameter covariance and
related statistics.</p>
<p>The fixed effects estimator can handle general fixed effects, not just
entity. While it has special cases that simplify adding entity and/or
time effects, general effects can also be used. For example, one might
want to use industry effect rather than firm effects. Generally the
fixed effect model can be expressed as a least squares dummy variable
(LSDV) estimator of the form</p>
<div class="math">
\[y_{it}=x_{it}\beta+d_{1,it}\gamma_{1}+d_{2,it}\gamma_{2}\]</div>
<p>where <span class="math">\(d_{1,it}\)</span> and <span class="math">\(d_{2,it}\)</span> are the dummy variables for
the first and second effect. When the model contains an intercept, one
dummy is dropped form each group and the dummies are orthogonalized to a
constant so that they have mean 0. This allows the constant to be
estimated. If the model does not contain an intercept, the first group
of dummies will contain all values and the second will have one dropped.</p>
<p><strong>Weights</strong></p>
<p>When weights are used, the results are identical to the LSDV model where
all variables <span class="math">\(y_{it,}\)</span><span class="math">\(x_{it}\)</span>, <span class="math">\(d_{1,it}\)</span> and
<span class="math">\(d_{2,it}\)</span>(if included) are multiplied by <span class="math">\(\sqrt{w_{it}}\)</span>.</p>
</div>
<div class="section" id="random-effect-estimation-randomeffects">
<h3>Random Effect Estimation (RandomEffects)<a class="headerlink" href="#random-effect-estimation-randomeffects" title="Permalink to this headline">¶</a></h3>
<p>The random effects estimator makes use of a quasi-differenced model,</p>
<div class="math">
\[y_{it}-\hat{\theta}_{i}\bar{y}_{i}=\left(1-\hat{\theta}_{i}\right)\alpha_{i}+(x_{it}-\hat{\theta}_{i}x_{i})\beta+\left(\epsilon_{it}-\hat{\theta}_{i}\bar{\epsilon}_{i}\right)\]</div>
<p>where <span class="math">\(\theta_{i}\)</span> is a function of the variance of
<span class="math">\(\epsilon_{it}\)</span> , the variance of <span class="math">\(\alpha_{i}\)</span> and the
number of observations for entity <span class="math">\(i\)</span>,</p>
<div class="math">
\[\hat{\theta}_{i}=1-\sqrt{\frac{\sigma_{\epsilon}^{2}}{T_{i}\sigma_{\alpha}^{2}+\sigma_{\epsilon}^{2}}}\]</div>
<p>so that <span class="math">\(\hat{\theta}_{i}\approx1\)</span> when <span class="math">\(T_{i}\)</span> is large (as
long as <span class="math">\(\sigma_{\alpha}^{2}&gt;0\)</span>) or when <span class="math">\(\alpha_{i}\)</span> is the
only source of variance. On the other hand,
<span class="math">\(\hat{\theta}_{i}\approx0\)</span> when the variation due to
<span class="math">\(\alpha_{i}\)</span> is low. The estimator of the idiosyncratic variance
is</p>
<div class="math">
\[\frac{\sum_{i=1}^{N}\sum_{t=1}^{T_{i}}\hat{\epsilon}_{it}^{2}}{\sum_{i=1}^{N}T_{i}-N-K+c}\]</div>
<p>where <span class="math">\(c=1\)</span> if the model includes a constant in the regressors.
The variance of <span class="math">\(\alpha_{i}\)</span> is estimated using the residual sum
of squares from the between regression (see below), <span class="math">\(RSS_{b}\)</span>,</p>
<div class="math">
\[\hat{\sigma}_{\alpha}^{2}=\max\{0,\frac{RSS_{b}}{N-K}-\frac{\hat{\sigma}_{\epsilon}^{2}}{\bar{T}}\}\]</div>
<p>where <span class="math">\(\bar{T}=\frac{n}{\sum_{i=1}^{n}T_{i}^{-1}}\)</span>. If the
optional argument for a small sample adjustment is used, the Baltagi and
Chang (1994) estimator is used. This only has an effect when the data
are unbalanced.</p>
<p><strong>Weights</strong></p>
<p>When weights are included the averages are replaced by weighted averages
and the final regression terms are all multiplied by
<span class="math">\(\sqrt{w_{it}}\)</span>.</p>
</div>
<div class="section" id="between-estimation-betweenols">
<h3>Between Estimation (BetweenOLS)<a class="headerlink" href="#between-estimation-betweenols" title="Permalink to this headline">¶</a></h3>
<p>Between estimation regresses time averages of the dependent variable on
the time averaged values of the regressors,</p>
<div class="math">
\[\bar{y}_{i}=\bar{x}_{i}\beta+\bar{\epsilon}_{i}.\]</div>
<p>When weights are included, weighted averages are used so that</p>
<div class="math">
\[\bar{y}_{i}^{w}=\frac{\sum_{t=1}^{T}w_{it}y_{it}}{\sum_{t=1}^{T}w_{it}}\]</div>
<p>with <span class="math">\(\bar{x}_{i}\)</span> similarly defined. Note that if the conditional
variance of <span class="math">\(y_{it}\propto w_{it}^{-1}\)</span> then the conditional
variance of <span class="math">\(\bar{y}_{i}^{w}\propto\frac{1}{\sum w_{i}}\)</span> and these
weights are used when regressing the weighted averages. Also note that
when <span class="math">\(w_{i}=1\)</span> but the panel is imbalanced than the conditional
variance of <span class="math">\(\bar{y}_{i}^{w}=\bar{y}_{i}\propto\frac{1}{T_{i}}\)</span>.
Re-weighting unbalanced panels is exposed through the fit option
<code class="docutils literal"><span class="pre">reweight</span></code>.</p>
<p><strong>Weights</strong></p>
<p>When weights are used, the averages are replaced by weighted averages
and reweighting uses the computed variance of the weighted averages in
the actual between regression.</p>
</div>
<div class="section" id="first-difference-estimation-firstdifferenceols">
<h3>First Difference Estimation (FirstDifferenceOLS)<a class="headerlink" href="#first-difference-estimation-firstdifferenceols" title="Permalink to this headline">¶</a></h3>
<p>First difference estimation regresses first difference of the dependent
variable on the first difference the regressors,</p>
<div class="math">
\[\Delta y_{it}=\Delta x_{it}\beta+\Delta\epsilon_{it}.\]</div>
<p><strong>Weights</strong></p>
<p>When weights are included, weighted are summed to that the weight on
<span class="math">\(\Delta y_{it}\)</span> is
<span class="math">\(\left(w_{it}^{-1}+w_{it-1}^{-1}\right)^{-1}\)</span> which exploits that
the structure that conditional variance of
<span class="math">\(y_{it}\propto w_{it}^{-1}\)</span> and the variance of the difference is
the sum of the variances when observations are uncorrelated.</p>
</div>
<div class="section" id="pooled-model-estimation-pooledols">
<h3>Pooled Model Estimation (PooledOLS)<a class="headerlink" href="#pooled-model-estimation-pooledols" title="Permalink to this headline">¶</a></h3>
<p>The pooled estimator is a standard regression,</p>
<div class="math">
\[y_{it}=x_{it}\beta+\epsilon_{it}.\]</div>
<p><strong>Weights</strong></p>
<p>When weights are included, the data is transformed by multiplying with
the square root of the weights prior to the regression (i.e.,
<span class="math">\(y_{it}\)</span> is replaced by <span class="math">\(\sqrt{w_{it}}y_{it}\)</span> and
<span class="math">\(x_{it}\)</span> is similarly transformed).</p>
</div>
</div>
<div class="section" id="covariance-estimators">
<h2>Covariance Estimators<a class="headerlink" href="#covariance-estimators" title="Permalink to this headline">¶</a></h2>
<div class="section" id="standard-covariance-estimator-unadjusted">
<h3>Standard Covariance Estimator (unadjusted)<a class="headerlink" href="#standard-covariance-estimator-unadjusted" title="Permalink to this headline">¶</a></h3>
<p>The standard covariance estimator is</p>
<div class="math">
\[s^{2}\Sigma_{XX}^{-1}\]</div>
<p>where</p>
<div class="math">
\[\Sigma_{XX}=\sum_{i=1}^{N}\sum_{t=1}^{T_{i}}x_{it}^{\prime}x_{it}\]</div>
<p>and</p>
<div class="math">
\[s^{2}=(n_{obs}-k)\sum_{i=1}^{N}\sum_{t=1}^{Ti}\hat{\epsilon}_{it}^{2}\]</div>
<p>where <span class="math">\(n_{obs}=\sum_{i=1}^{N}T_{i}\)</span>. If the debiased options is
not used, the <span class="math">\(k\)</span> is omitted.</p>
</div>
<div class="section" id="heteroskedastic-covariance-estimator-robust">
<h3>Heteroskedastic Covariance Estimator (robust)<a class="headerlink" href="#heteroskedastic-covariance-estimator-robust" title="Permalink to this headline">¶</a></h3>
<p>The standard covariance estimator is</p>
<div class="math">
\[n_{obs}/(n_{obs}-k)\Sigma_{XX}^{-1}\hat{S}\Sigma_{XX}^{-1}\]</div>
<p>where</p>
<div class="math">
\[\hat{S}=\sum_{i=1}^{N}\sum_{t=1}^{T_{i}}\hat{\epsilon}_{it}^{2}x_{it}^{\prime}x_{it}.\]</div>
<p>The <span class="math">\(-k\)</span> term is dropped if the debiased options is not used</p>
</div>
<div class="section" id="clustered-covariance-estimator">
<h3>Clustered Covariance Estimator<a class="headerlink" href="#clustered-covariance-estimator" title="Permalink to this headline">¶</a></h3>
<p>The clustered covariance estimator supports 1 and 2 way clustering.</p>
<div class="math">
\[n_{obs}/(n_{obs}-k)\Sigma_{XX}^{-1}\hat{S}_{\mathcal{G}}\Sigma_{XX}^{-1}\]</div>
<p>where in the case of one-way clustering,</p>
<div class="math">
\[\hat{S}_{\mathcal{G}}=\frac{G}{G-1}\frac{n_{obs}-1}{n_{obs}}\sum_{g=1}^{G}\xi_{g}^{\prime}\xi_{g}\]</div>
<p>where</p>
<div class="math">
\[\xi_{g}=\sum_{it\in G_{g}}\hat{\epsilon}_{ii}^{2}x_{it}^{\prime}x_{it}\]</div>
<p>and <span class="math">\(it\in G_{g}\)</span> indicates that observation belongs to group
<span class="math">\(g\)</span>. The two-way clustered replaces
<span class="math">\(\hat{S}_{\mathcal{G}}\)</span>by</p>
<div class="math">
\[\hat{S}_{\mathcal{G}_{1}}+\hat{S}_{\mathcal{G}_{2}}-\hat{S}_{\mathcal{G}_{1}\cap\mathcal{G}_{2}}.\]</div>
<p>Where the group debiasing is applies individually to each of the three
components depending on the number of groups in the three estimators. If
the group debias term is not used, the expression
<span class="math">\(\frac{G}{G-1}\frac{n_{obs}-1}{n_{obs}}\)</span> is omitted. The
<span class="math">\(-k\)</span> term is dropped if the debiased estimator is not used.</p>
<p><strong>Clustering by Variables used as Effects</strong></p>
<p>When clustering by the same variable used in the effect estimation,
e.g., entity effects with clustering by entity, there the degrees of
freedom used in estimating the effects are <em>not</em> counted.</p>
</div>
<div class="section" id="driscoll-kraay-covariance-estimator">
<h3>Driscoll-Kraay Covariance Estimator<a class="headerlink" href="#driscoll-kraay-covariance-estimator" title="Permalink to this headline">¶</a></h3>
<p>The Driscoll-Kraay covariance estimator may be appropriate when the
number of time periods is relatively large (e.g., a large T panel), and
are given by</p>
<div class="math">
\[n_{obs}/(n_{obs}-k)\Sigma_{XX}^{-1}\hat{S}_{HAC}\Sigma_{XX}^{-1}\]</div>
<p>where</p>
<div class="math">
\[\begin{split}\begin{aligned}
\hat{S}_{HAC} &amp; =\hat{\Gamma}_{0}+\sum_{i=1}^{bw}K(i,bw)(\hat{\Gamma}_{1}+\hat{\Gamma}_{1}^{\prime})\\
\hat{\Gamma}_{i} &amp; =\sum_{t=i+1}^{T}\xi_{t}^{\prime}\xi_{t}\\
\xi_{t} &amp; =\sum_{i=1}^{n_{t}}\hat{\epsilon}_{it}x_{it}\end{aligned}\end{split}\]</div>
<p>and <span class="math">\(K\left(i,bw\right)\)</span> is a kernel weighting function. Kernel
supported include the Bartlett, Parzen and Quadratic Spectral.</p>
</div>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="data.html" title="previous chapter (use the left arrow)">Panel Data Structures</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="faq.html" title="next chapter (use the right arrow)">Implementation Choices</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Implementation Choices"
             >next</a> |</li>
        <li class="right" >
          <a href="data.html" title="Panel Data Structures"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">linearmodels 3.5+15.gd85af6a documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Panel Data Model Estimation</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2017, Kevin Sheppard. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>