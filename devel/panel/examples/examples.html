

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Examples &#8212; linearmodels 3.5+13.ga8e016a documentation</title>
    <link rel="stylesheet" href="../../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.5+13.ga8e016a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using formulas to specify models" href="using-formulas.html" />
    <link rel="prev" title="Data Formats for Panel Data Analysis" href="data-formats.html" />
  
  
   

  <link rel="stylesheet" href="../../_static/css/overrides.css" type="text/css" />

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="using-formulas.html" title="Using formulas to specify models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="data-formats.html" title="Data Formats for Panel Data Analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">linearmodels 3.5+13.ga8e016a documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Panel Data Model Estimation</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
        <a href="
    ../../index.html" class="text-logo">linearmodels 3.5 (+13, ga8e016a)</a>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../iv/index.html">Instrumental Variable Estimation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Panel Data Model Estimation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-formats.html">Data Formats for Panel Data Analysis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="using-formulas.html">Using formulas to specify models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pandas.html">Comparison with pandas PanelOLS and FamaMacBeth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference.html">Module Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mathematical-formula.html">Formulas and Mathematical Detail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html">Implementation Choices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../asset-pricing/index.html">Linear Factor Models for Asset Pricing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../system/index.html">System Regression Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utility.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plan.html">Module Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

    
  </div>
</div>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../../index.html">Docs</a></li>
              
                <li><a href="../index.html">Panel Data Model Estimation</a></li>
              
              <li>Examples</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="section" id="Examples">
<h1>Examples<a class="headerlink" href="#Examples" title="Permalink to this headline">¶</a></h1>
<p>These examples cover the models available for estimating panel models.
The initial examples all ignore covariance options and so use the
default classic covariance which is appropriate for homoskedastic data.
The alternative covariance options are described at the end of this
document.</p>
<div class="section" id="Loading-data">
<h2>Loading data<a class="headerlink" href="#Loading-data" title="Permalink to this headline">¶</a></h2>
<p>These examples all make use of the wage panel from</p>
<p>F. Vella and M. Verbeek (1998), “Whose Wages Do Unions Raise? A Dynamic
Model of Unionism and Wage Rate Determination for Young Men,” <em>Journal
of Applied Econometrics</em> 13, 163-183.</p>
<p>The data set consists of wages and characteristics for men during the
1980s. The entity identifier is <code class="docutils literal"><span class="pre">nr</span></code> and the time identified is
<code class="docutils literal"><span class="pre">year</span></code>. This data is used extensively in Chapter 14 of <em>Introduction
to Econometrics</em> by Jeffrey Wooldridge.</p>
<p>Here a <code class="docutils literal"><span class="pre">MultiIndex</span></code> <code class="docutils literal"><span class="pre">DataFrame</span></code> is used to hold the data in a format
that can be understood as a panel. Before setting the index, a year
<code class="docutils literal"><span class="pre">Categorical</span></code> is created which facilitated making dummies.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.datasets</span> <span class="kn">import</span> <span class="n">wage_panel</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">wage_panel</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">year</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;nr&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span>
<span class="k">print</span><span class="p">(</span><span class="n">wage_panel</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

F. Vella and M. Verbeek (1998), &#34;Whose Wages Do Unions Raise? A Dynamic Model
of Unionism and Wage Rate Determination for Young Men,&#34; Journal of Applied
Econometrics 13, 163-183.

nr                       person identifier
year                     1980 to 1987
black                    =1 if black
exper                    labor market experience
hisp                     =1 if Hispanic
hours                    annual hours worked
married                  =1 if married
educ                     years of schooling
union                    =1 if in union
lwage                    log(wage)
expersq                  exper^2
occupation               Occupation code

         black  exper  hisp  hours  married  educ  union     lwage  expersq  \
nr year
13 1980      0      1     0   2672        0    14      0  1.197540        1
   1981      0      2     0   2320        0    14      1  1.853060        4
   1982      0      3     0   2940        0    14      0  1.344462        9
   1983      0      4     0   2960        0    14      0  1.433213       16
   1984      0      5     0   3071        0    14      0  1.568125       25

         occupation  year
nr year
13 1980           9  1980
   1981           9  1981
   1982           9  1982
   1983           9  1983
   1984           5  1984
</pre></div></div>
</div>
</div>
<div class="section" id="Basic-regression-on-panel-data">
<h2>Basic regression on panel data<a class="headerlink" href="#Basic-regression-on-panel-data" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">PooledOLS</span></code> is just plain OLS that understands that various panel data
structures. It is useful as a base model. Here the log wage is modeled
using all of the variables and time dummies.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.panel</span> <span class="kn">import</span> <span class="n">PooledOLS</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="kn">as</span> <span class="nn">sm</span>
<span class="n">exog_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;hisp&#39;</span><span class="p">,</span><span class="s1">&#39;exper&#39;</span><span class="p">,</span><span class="s1">&#39;expersq&#39;</span><span class="p">,</span><span class="s1">&#39;married&#39;</span><span class="p">,</span> <span class="s1">&#39;educ&#39;</span><span class="p">,</span> <span class="s1">&#39;union&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]</span>
<span class="n">exog</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">exog_vars</span><span class="p">])</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">PooledOLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lwage</span><span class="p">,</span> <span class="n">exog</span><span class="p">)</span>
<span class="n">pooled_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">pooled_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/home/travis/miniconda3/envs/linearmodels-test/lib/python3.5/site-packages/statsmodels/compat/pandas.py:56: FutureWarning: The pandas.core.datetools module is deprecated and will be removed in a future version. Please use the pandas.tseries module instead.
  from pandas.core import datetools
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          PooledOLS Estimation Summary
================================================================================
Dep. Variable:                  lwage   R-squared:                        0.1893
Estimator:                  PooledOLS   R-squared (Between):              0.2066
No. Observations:                4360   R-squared (Within):               0.1692
Date:                Sun, Aug 06 2017   R-squared (Overall):              0.1893
Time:                        16:04:19   Log-likelihood                   -2982.0
Cov. Estimator:            Unadjusted
                                        F-statistic:                      72.459
Entities:                         545   P-value                           0.0000
Avg Obs:                       8.0000   Distribution:                 F(14,4345)
Min Obs:                       8.0000
Max Obs:                       8.0000   F-statistic (robust):             72.459
                                        P-value                           0.0000
Time periods:                       8   Distribution:                 F(14,4345)
Avg Obs:                       545.00
Min Obs:                       545.00
Max Obs:                       545.00

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0921     0.0783     1.1761     0.2396     -0.0614      0.2455
black         -0.1392     0.0236    -5.9049     0.0000     -0.1855     -0.0930
hisp           0.0160     0.0208     0.7703     0.4412     -0.0248      0.0568
exper          0.0672     0.0137     4.9095     0.0000      0.0404      0.0941
expersq       -0.0024     0.0008    -2.9413     0.0033     -0.0040     -0.0008
married        0.1083     0.0157     6.8997     0.0000      0.0775      0.1390
educ           0.0913     0.0052     17.442     0.0000      0.0811      0.1016
union          0.1825     0.0172     10.635     0.0000      0.1488      0.2161
year.1981      0.0583     0.0304     1.9214     0.0548     -0.0012      0.1178
year.1982      0.0628     0.0332     1.8900     0.0588     -0.0023      0.1279
year.1983      0.0620     0.0367     1.6915     0.0908     -0.0099      0.1339
year.1984      0.0905     0.0401     2.2566     0.0241      0.0119      0.1691
year.1985      0.1092     0.0434     2.5200     0.0118      0.0243      0.1942
year.1986      0.1420     0.0464     3.0580     0.0022      0.0509      0.2330
year.1987      0.1738     0.0494     3.5165     0.0004      0.0769      0.2707
==============================================================================
</pre></div></div>
</div>
</div>
<div class="section" id="Estimating-parameters-with-uncorrelated-effects">
<h2>Estimating parameters with uncorrelated effects<a class="headerlink" href="#Estimating-parameters-with-uncorrelated-effects" title="Permalink to this headline">¶</a></h2>
<p>When modeling panel data it is common to consider models beyond what OLS
will efficiently estimate. The most common are error component models
which add an additional term to the standard OLS model,</p>
<div class="math">
\[y_{it} = x_{it}\beta + \alpha_{i} + \epsilon_{it}\]</div>
<p>where <span class="math">\(\alpha_i\)</span> affects all values of entity i. When the
<span class="math">\(\alpha_i\)</span> are uncorrelated with the regressors in <span class="math">\(x_{it}\)</span>,
a random effects model can be used to efficiently estimate parameters of
this model.</p>
<div class="section" id="Random-effects">
<h3>Random effects<a class="headerlink" href="#Random-effects" title="Permalink to this headline">¶</a></h3>
<p>The random effects model is virtually identical to the pooled OLS model
except that is accounts for the structure of the model and so is more
efficient. Random effects uses a quasi-demeaning strategy which
subtracts the time average fo the within entity values to account for
the common shock.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.panel</span> <span class="kn">import</span> <span class="n">RandomEffects</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">RandomEffects</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lwage</span><span class="p">,</span> <span class="n">exog</span><span class="p">)</span>
<span class="n">re_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">re_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                        RandomEffects Estimation Summary
================================================================================
Dep. Variable:                  lwage   R-squared:                        0.1806
Estimator:              RandomEffects   R-squared (Between):              0.1853
No. Observations:                4360   R-squared (Within):               0.1799
Date:                Sun, Aug 06 2017   R-squared (Overall):              0.1828
Time:                        16:04:19   Log-likelihood                   -1622.5
Cov. Estimator:            Unadjusted
                                        F-statistic:                      68.409
Entities:                         545   P-value                           0.0000
Avg Obs:                       8.0000   Distribution:                 F(14,4345)
Min Obs:                       8.0000
Max Obs:                       8.0000   F-statistic (robust):             68.409
                                        P-value                           0.0000
Time periods:                       8   Distribution:                 F(14,4345)
Avg Obs:                       545.00
Min Obs:                       545.00
Max Obs:                       545.00

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.0234     0.1514     0.1546     0.8771     -0.2735      0.3203
black         -0.1394     0.0480    -2.9054     0.0037     -0.2334     -0.0453
hisp           0.0217     0.0428     0.5078     0.6116     -0.0622      0.1057
exper          0.1058     0.0154     6.8706     0.0000      0.0756      0.1361
expersq       -0.0047     0.0007    -6.8623     0.0000     -0.0061     -0.0034
married        0.0638     0.0168     3.8035     0.0001      0.0309      0.0967
educ           0.0919     0.0107     8.5744     0.0000      0.0709      0.1129
union          0.1059     0.0179     5.9289     0.0000      0.0709      0.1409
year.1981      0.0404     0.0247     1.6362     0.1019     -0.0080      0.0889
year.1982      0.0309     0.0324     0.9519     0.3412     -0.0327      0.0944
year.1983      0.0202     0.0417     0.4840     0.6284     -0.0616      0.1020
year.1984      0.0430     0.0515     0.8350     0.4037     -0.0580      0.1440
year.1985      0.0577     0.0615     0.9383     0.3482     -0.0629      0.1782
year.1986      0.0918     0.0716     1.2834     0.1994     -0.0485      0.2321
year.1987      0.1348     0.0817     1.6504     0.0989     -0.0253      0.2950
==============================================================================
</pre></div></div>
</div>
<p>The model fit is fairly similar, although the return to experience has
changed substantially, as has its significance. This is partially
explainable by the inclusion of the year dummies which will fit the
trend in experience and so only the cross-sectional differences matter.
The quasi-differencing in the random effects estimator depends on a
quantity that depends on the relative variance of the idiosyncratic
shock and the common shock. This can be accessed using
<code class="docutils literal"><span class="pre">variance_decomposition</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">re_res</span><span class="o">.</span><span class="n">variance_decomposition</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>Effects                   0.106946
Residual                  0.123324
Percent due to Effects    0.464438
Name: Variance Decomposition, dtype: float64
</pre></div>
</div>
</div>
<p>The coefficient <span class="math">\(\theta_i\)</span> determines how much demeaning takes
place. When this value is 1, the RE model reduces to the pooled model
since this occurs when there is no variance in the effects. When panels
are unbalanced it will vary across entities, but in this balanced panel
all values are the same.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">re_res</span><span class="o">.</span><span class="n">theta</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>theta</th>
    </tr>
    <tr>
      <th>entity</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>0.645059</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.645059</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.645059</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0.645059</td>
    </tr>
    <tr>
      <th>110</th>
      <td>0.645059</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="The-between-estimator">
<h3>The between estimator<a class="headerlink" href="#The-between-estimator" title="Permalink to this headline">¶</a></h3>
<p>The between estimator is an alternative, usually less efficient
estimator, can can be used to estimate model parameters. It is
particular simple since it first computes the time averages of <span class="math">\(y\)</span>
and <span class="math">\(x\)</span> and then runs a simple regression using these averages.</p>
<p>The year dummies are dropped since the averaging removes differences due
to the year. <code class="docutils literal"><span class="pre">expersq</span></code> was also dropped since it is fairly co-linear
with <code class="docutils literal"><span class="pre">exper</span></code>. These results are broadly similar to the previous
models.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.panel</span> <span class="kn">import</span> <span class="n">BetweenOLS</span>
<span class="n">exog_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;hisp&#39;</span><span class="p">,</span><span class="s1">&#39;exper&#39;</span><span class="p">,</span><span class="s1">&#39;married&#39;</span><span class="p">,</span> <span class="s1">&#39;educ&#39;</span><span class="p">,</span> <span class="s1">&#39;union&#39;</span><span class="p">]</span>
<span class="n">exog</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">exog_vars</span><span class="p">])</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">BetweenOLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lwage</span><span class="p">,</span> <span class="n">exog</span><span class="p">)</span>
<span class="n">be_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">be_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                         BetweenOLS Estimation Summary
================================================================================
Dep. Variable:                  lwage   R-squared:                        0.2155
Estimator:                 BetweenOLS   R-squared (Between):              0.2155
No. Observations:                 545   R-squared (Within):               0.1141
Date:                Sun, Aug 06 2017   R-squared (Overall):              0.1686
Time:                        16:04:19   Log-likelihood                   -194.54
Cov. Estimator:            Unadjusted
                                        F-statistic:                      24.633
Entities:                         545   P-value                           0.0000
Avg Obs:                       8.0000   Distribution:                   F(6,538)
Min Obs:                       8.0000
Max Obs:                       8.0000   F-statistic (robust):             24.633
                                        P-value                           0.0000
Time periods:                       8   Distribution:                   F(6,538)
Avg Obs:                       545.00
Min Obs:                       545.00
Max Obs:                       545.00

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          0.2836     0.1784     1.5897     0.1125     -0.0668      0.6340
black         -0.1414     0.0489    -2.8915     0.0040     -0.2375     -0.0453
hisp           0.0100     0.0426     0.2355     0.8139     -0.0737      0.0938
exper          0.0278     0.0113     2.4538     0.0144      0.0055      0.0501
married        0.1416     0.0412     3.4346     0.0006      0.0606      0.2226
educ           0.0913     0.0107     8.5159     0.0000      0.0702      0.1123
union          0.2587     0.0460     5.6214     0.0000      0.1683      0.3491
==============================================================================
</pre></div></div>
</div>
<div class="section" id="Other-options">
<h4>Other options<a class="headerlink" href="#Other-options" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">fit</span></code> method of <code class="docutils literal"><span class="pre">BetweenOLS</span></code> takes an optional input
<code class="docutils literal"><span class="pre">reweight</span></code> which uses GLS-like weighting when panels are unbalanced.
In this dataset the panel is balanced and so using this option would
have no effect. By default this is <code class="docutils literal"><span class="pre">False</span></code> and so the averages are
directly used in OLS even when there are difference numbers of
observations across entities.</p>
</div>
</div>
</div>
<div class="section" id="Handling-correlated-effects">
<h2>Handling correlated effects<a class="headerlink" href="#Handling-correlated-effects" title="Permalink to this headline">¶</a></h2>
<p>When effects are correlated with the regressors the RE and BE estimators
are not consistent. The usual solution is to use Fixed Effects which are
available in <code class="docutils literal"><span class="pre">PanelOLS</span></code>. Fixed effects are called <code class="docutils literal"><span class="pre">entity_effects</span></code>
when applied to entities and <code class="docutils literal"><span class="pre">time_effects</span></code> when applied to the time
dimension:</p>
<div class="section" id="Including-fixed-effects">
<h3>Including fixed effects<a class="headerlink" href="#Including-fixed-effects" title="Permalink to this headline">¶</a></h3>
<p>Entity effects are included by setting <code class="docutils literal"><span class="pre">entity_effects=True</span></code>. This is
equivalent to including dummies for each entity. In this panel, this
would add 545 dummy variables and estimation of the model would be
considerably slower. <code class="docutils literal"><span class="pre">PanelOLS</span></code> does not actually use dummy variables
and instead uses group-wise demeaning to achieve the same effect.</p>
<div class="section" id="Time-invariant-Variables">
<h4>Time-invariant Variables<a class="headerlink" href="#Time-invariant-Variables" title="Permalink to this headline">¶</a></h4>
<p>Time-invariant variables cannot be included when using entity effects
since, once demeaned, these will all be 0. Here <code class="docutils literal"><span class="pre">exper</span></code> is also
excluded since once entity effects and time dummies are incorporated,
<code class="docutils literal"><span class="pre">exper</span></code> is perfectly co-linear.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.panel</span> <span class="kn">import</span> <span class="n">PanelOLS</span>
<span class="n">exog_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;expersq&#39;</span><span class="p">,</span> <span class="s1">&#39;union&#39;</span><span class="p">,</span> <span class="s1">&#39;married&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]</span>
<span class="n">exog</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">exog_vars</span><span class="p">])</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">PanelOLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lwage</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">entity_effects</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">fe_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">fe_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          PanelOLS Estimation Summary
================================================================================
Dep. Variable:                  lwage   R-squared:                        0.1806
Estimator:                   PanelOLS   R-squared (Between):             -0.0052
No. Observations:                4360   R-squared (Within):               0.1806
Date:                Sun, Aug 06 2017   R-squared (Overall):              0.0807
Time:                        16:04:20   Log-likelihood                   -1324.8
Cov. Estimator:            Unadjusted
                                        F-statistic:                      83.851
Entities:                         545   P-value                           0.0000
Avg Obs:                       8.0000   Distribution:                 F(10,3805)
Min Obs:                       8.0000
Max Obs:                       8.0000   F-statistic (robust):             83.851
                                        P-value                           0.0000
Time periods:                       8   Distribution:                 F(10,3805)
Avg Obs:                       545.00
Min Obs:                       545.00
Max Obs:                       545.00

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          1.4260     0.0183     77.748     0.0000      1.3901      1.4620
expersq       -0.0052     0.0007    -7.3612     0.0000     -0.0066     -0.0038
union          0.0800     0.0193     4.1430     0.0000      0.0421      0.1179
married        0.0467     0.0183     2.5494     0.0108      0.0108      0.0826
year.1981      0.1512     0.0219     6.8883     0.0000      0.1082      0.1942
year.1982      0.2530     0.0244     10.360     0.0000      0.2051      0.3008
year.1983      0.3544     0.0292     12.121     0.0000      0.2971      0.4118
year.1984      0.4901     0.0362     13.529     0.0000      0.4191      0.5611
year.1985      0.6175     0.0452     13.648     0.0000      0.5288      0.7062
year.1986      0.7655     0.0561     13.638     0.0000      0.6555      0.8755
year.1987      0.9250     0.0688     13.450     0.0000      0.7902      1.0599
==============================================================================

F-test for Poolability: 9.1568
P-value: 0.0000
Distribution: F(544,3805)

Included effects: Entity
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Time-Effects">
<h3>Time Effects<a class="headerlink" href="#Time-Effects" title="Permalink to this headline">¶</a></h3>
<p>Time effect can be added using <code class="docutils literal"><span class="pre">time_effects=True</span></code>. Here the time
dummies are removed. Note that the core coefficients are identical. The
only change is in the test statistic for poolability since not the
“effects” include both entity and time, whereas before only entity were
included.</p>
<div class="section" id="Effects-vs-Dummies">
<h4>Effects vs Dummies<a class="headerlink" href="#Effects-vs-Dummies" title="Permalink to this headline">¶</a></h4>
<p>For variable which can be consistently estimated, such as time effects
in the usual large N, fixed T panel, it isn’t necessary to include these
as effects. They can instead be implemented as dummy variables.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.panel</span> <span class="kn">import</span> <span class="n">PanelOLS</span>
<span class="n">exog_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;expersq&#39;</span><span class="p">,</span><span class="s1">&#39;union&#39;</span><span class="p">,</span><span class="s1">&#39;married&#39;</span><span class="p">]</span>
<span class="n">exog</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">exog_vars</span><span class="p">])</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">PanelOLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lwage</span><span class="p">,</span> <span class="n">exog</span><span class="p">,</span> <span class="n">entity_effects</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">time_effects</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">fe_te_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">fe_te_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                          PanelOLS Estimation Summary
================================================================================
Dep. Variable:                  lwage   R-squared:                        0.0216
Estimator:                   PanelOLS   R-squared (Between):             -0.0052
No. Observations:                4360   R-squared (Within):              -0.4809
Date:                Sun, Aug 06 2017   R-squared (Overall):             -0.2253
Time:                        16:04:20   Log-likelihood                   -1324.8
Cov. Estimator:            Unadjusted
                                        F-statistic:                      27.959
Entities:                         545   P-value                           0.0000
Avg Obs:                       8.0000   Distribution:                  F(3,3805)
Min Obs:                       8.0000
Max Obs:                       8.0000   F-statistic (robust):             27.959
                                        P-value                           0.0000
Time periods:                       8   Distribution:                  F(3,3805)
Avg Obs:                       545.00
Min Obs:                       545.00
Max Obs:                       545.00

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const          1.8706     0.0378     49.430     0.0000      1.7964      1.9448
expersq       -0.0052     0.0007    -7.3612     0.0000     -0.0066     -0.0038
union          0.0800     0.0193     4.1430     0.0000      0.0421      0.1179
married        0.0467     0.0183     2.5494     0.0108      0.0108      0.0826
==============================================================================

F-test for Poolability: 10.067
P-value: 0.0000
Distribution: F(551,3805)

Included effects: Entity, Time
</pre></div></div>
</div>
</div>
<div class="section" id="Other-Options">
<h4>Other Options<a class="headerlink" href="#Other-Options" title="Permalink to this headline">¶</a></h4>
<p>Some additional options are available when using <code class="docutils literal"><span class="pre">PanelOLS</span></code> and
effects. The <code class="docutils literal"><span class="pre">use_lsdv</span></code> can be used to force the mdoel to be estimated
using dummy variables. This isn’t necessary and will be slower in most
circumstances. This options is primarily included for testing.
<code class="docutils literal"><span class="pre">auto_df</span></code> instructs <code class="docutils literal"><span class="pre">PanelOLS</span></code> to determine the degree of freedom
adjustment to make. Unlike most other estimators, the treatment of
effects depends on the covariance estimator. For example, when using a
classic covariance estimator, effects count as lost degrees of freedom.
When using entity effects and clustering by entity, they do not. Setting
<code class="docutils literal"><span class="pre">auto_df=False</span></code> will allow the entities to be counted or not,
depending on the value of <code class="docutils literal"><span class="pre">count_effects</span></code>.</p>
</div>
</div>
<div class="section" id="Using-first-differences">
<h3>Using first differences<a class="headerlink" href="#Using-first-differences" title="Permalink to this headline">¶</a></h3>
<p>First differencing is an alternative to using fixed effects when there
might be correlation. When using first differences, time-invariant
variables must be excluded. Additionally, only one linear time-trending
variable can be included since this will look like a constant. This
variable will soak up all time-trends in the data, and so
interpretations of these variable can be challenging.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.panel</span> <span class="kn">import</span> <span class="n">FirstDifferenceOLS</span>
<span class="n">exog_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;exper&#39;</span><span class="p">,</span><span class="s1">&#39;expersq&#39;</span><span class="p">,</span> <span class="s1">&#39;union&#39;</span><span class="p">,</span> <span class="s1">&#39;married&#39;</span><span class="p">]</span>
<span class="n">exog</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">exog_vars</span><span class="p">]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">FirstDifferenceOLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lwage</span><span class="p">,</span> <span class="n">exog</span><span class="p">)</span>
<span class="n">fd_res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">fd_res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                     FirstDifferenceOLS Estimation Summary
================================================================================
Dep. Variable:                  lwage   R-squared:                        0.0268
Estimator:         FirstDifferenceOLS   R-squared (Between):              0.5491
No. Observations:                3815   R-squared (Within):               0.1763
Date:                Sun, Aug 06 2017   R-squared (Overall):              0.5328
Time:                        16:04:20   Log-likelihood                   -2305.5
Cov. Estimator:            Unadjusted
                                        F-statistic:                      26.208
Entities:                         545   P-value                           0.0000
Avg Obs:                       8.0000   Distribution:                  F(4,3811)
Min Obs:                       8.0000
Max Obs:                       8.0000   F-statistic (robust):             26.208
                                        P-value                           0.0000
Time periods:                       8   Distribution:                  F(4,3811)
Avg Obs:                       545.00
Min Obs:                       545.00
Max Obs:                       545.00

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
exper          0.1158     0.0196     5.9096     0.0000      0.0773      0.1542
expersq       -0.0039     0.0014    -2.8005     0.0051     -0.0066     -0.0012
union          0.0428     0.0197     2.1767     0.0296      0.0042      0.0813
married        0.0381     0.0229     1.6633     0.0963     -0.0068      0.0831
==============================================================================
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Comparing-models">
<h2>Comparing models<a class="headerlink" href="#Comparing-models" title="Permalink to this headline">¶</a></h2>
<p>Model results can be compared using <code class="docutils literal"><span class="pre">compare</span></code>. <code class="docutils literal"><span class="pre">compare</span></code> accepts
lists of results, a dictionary of results where the key is interpreted
as the model name.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.panel</span> <span class="kn">import</span> <span class="n">compare</span>
<span class="k">print</span><span class="p">(</span><span class="n">compare</span><span class="p">({</span><span class="s1">&#39;BE&#39;</span><span class="p">:</span><span class="n">be_res</span><span class="p">,</span><span class="s1">&#39;RE&#39;</span><span class="p">:</span><span class="n">re_res</span><span class="p">,</span><span class="s1">&#39;Pooled&#39;</span><span class="p">:</span><span class="n">pooled_res</span><span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                        Model Comparison
===============================================================
                                BE       Pooled              RE
---------------------------------------------------------------
Dep. Variable                lwage        lwage           lwage
Estimator               BetweenOLS    PooledOLS   RandomEffects
No. Observations               545         4360            4360
Cov. Est.               Unadjusted   Unadjusted      Unadjusted
R-squared                   0.2155       0.1893          0.1806
R-Squared (Within)          0.1141       0.1692          0.1799
R-Squared (Between)         0.2155       0.2066          0.1853
R-Squared (Overall)         0.1686       0.1893          0.1828
F-statistic                 24.633       72.459          68.409
P-value (F-stat)            0.0000       0.0000          0.0000
===================== ============ ============ ===============
black                      -0.1414      -0.1392         -0.1394
                         (-2.8915)    (-5.9049)       (-2.9054)
const                       0.2836       0.0921          0.0234
                          (1.5897)     (1.1761)        (0.1546)
educ                        0.0913       0.0913          0.0919
                          (8.5159)     (17.442)        (8.5744)
exper                       0.0278       0.0672          0.1058
                          (2.4538)     (4.9095)        (6.8706)
expersq                                 -0.0024         -0.0047
                                      (-2.9413)       (-6.8623)
hisp                        0.0100       0.0160          0.0217
                          (0.2355)     (0.7703)        (0.5078)
married                     0.1416       0.1083          0.0638
                          (3.4346)     (6.8997)        (3.8035)
union                       0.2587       0.1825          0.1059
                          (5.6214)     (10.635)        (5.9289)
year.1981                                0.0583          0.0404
                                       (1.9214)        (1.6362)
year.1982                                0.0628          0.0309
                                       (1.8900)        (0.9519)
year.1983                                0.0620          0.0202
                                       (1.6915)        (0.4840)
year.1984                                0.0905          0.0430
                                       (2.2566)        (0.8350)
year.1985                                0.1092          0.0577
                                       (2.5200)        (0.9383)
year.1986                                0.1420          0.0918
                                       (3.0580)        (1.2834)
year.1987                                0.1738          0.1348
                                       (3.5165)        (1.6504)
---------------------------------------------------------------

T-stats reported in parentheses
</pre></div></div>
</div>
</div>
<div class="section" id="Covariance-options">
<h2>Covariance options<a class="headerlink" href="#Covariance-options" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Heteroskedasticity-Robust-Covariance">
<h3>Heteroskedasticity Robust Covariance<a class="headerlink" href="#Heteroskedasticity-Robust-Covariance" title="Permalink to this headline">¶</a></h3>
<p>White’s robust covariance can be used by setting <code class="docutils literal"><span class="pre">cov_type='robust</span></code>.
This estimator adds some robustness against certain types of
specification issues but should not be used when using fixed effects
(entity effects) since it is no longer robust. Instead a clustered
covariance is required.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">exog_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;hisp&#39;</span><span class="p">,</span><span class="s1">&#39;exper&#39;</span><span class="p">,</span><span class="s1">&#39;expersq&#39;</span><span class="p">,</span><span class="s1">&#39;married&#39;</span><span class="p">,</span> <span class="s1">&#39;educ&#39;</span><span class="p">,</span> <span class="s1">&#39;union&#39;</span><span class="p">]</span>
<span class="n">exog</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">exog_vars</span><span class="p">])</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">PooledOLS</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">lwage</span><span class="p">,</span> <span class="n">exog</span><span class="p">)</span>
<span class="n">robust</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;robust&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Clustered-by-Entity">
<h3>Clustered by Entity<a class="headerlink" href="#Clustered-by-Entity" title="Permalink to this headline">¶</a></h3>
<p>The usual variable to cluster are are entity or entity and time. The can
be implemented using <code class="docutils literal"><span class="pre">cov_type='clustered'</span></code> and the additional keyword
arguments <code class="docutils literal"><span class="pre">cluster_entity=True</span></code> and/or <code class="docutils literal"><span class="pre">cluster_time=True</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">clust_entity</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;clustered&#39;</span><span class="p">,</span> <span class="n">cluster_entity</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This next example clusters by both.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">clust_entity_time</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;clustered&#39;</span><span class="p">,</span> <span class="n">cluster_entity</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cluster_time</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>An <code class="docutils literal"><span class="pre">OrderedDict</span></code> is used to hold the results for comparing models.
This allows the models to be named as well as for the order of the
models to be specified. A standard <code class="docutils literal"><span class="pre">dict</span></code> will produce effectively
random order.</p>
<p>Clustering on entity reduced the t-stats across the board. This suggests
there is important correlation in the residuals per entity. Clustering
by both also decreases the t-stats which suggests that there is
cross-sectional dependence in the data. <em>Note</em>: clustering by entity
addresses correlation across time and clustering by time controls for
correlation between entities in a time period.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
<span class="n">res</span><span class="p">[</span><span class="s1">&#39;Robust&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">robust</span>
<span class="n">res</span><span class="p">[</span><span class="s1">&#39;Entity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clust_entity</span>
<span class="n">res</span><span class="p">[</span><span class="s1">&#39;Entity-Time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clust_entity_time</span>
<span class="k">print</span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                     Model Comparison
=========================================================
                           Robust      Entity Entity-Time
---------------------------------------------------------
Dep. Variable               lwage       lwage       lwage
Estimator               PooledOLS   PooledOLS   PooledOLS
No. Observations             4360        4360        4360
Cov. Est.               Clustered   Clustered      Robust
R-squared                  0.1866      0.1866      0.1866
R-Squared (Within)         0.1679      0.1679      0.1679
R-Squared (Between)        0.2027      0.2027      0.2027
R-Squared (Overall)        0.1866      0.1866      0.1866
F-statistic                142.61      142.61      142.61
P-value (F-stat)           0.0000      0.0000      0.0000
===================== =========== =========== ===========
const                     -0.0347     -0.0347     -0.0347
                        (-0.5360)   (-0.2892)   (-0.3145)
black                     -0.1438     -0.1438     -0.1438
                        (-5.9045)   (-2.8727)   (-3.0067)
hisp                       0.0157      0.0157      0.0157
                         (0.7952)    (0.4008)    (0.4428)
exper                      0.0892      0.0892      0.0892
                         (8.7881)    (7.1728)    (6.3223)
expersq                   -0.0028     -0.0028     -0.0028
                        (-4.1934)   (-3.2747)   (-3.1571)
married                    0.1077      0.1077      0.1077
                         (7.0525)    (4.1314)    (4.8989)
educ                       0.0994      0.0994      0.0994
                         (21.626)    (10.802)    (12.296)
union                      0.1801      0.1801      0.1801
                         (11.087)    (6.5343)    (6.6732)
---------------------------------------------------------

T-stats reported in parentheses
</pre></div></div>
</div>
</div>
<div class="section" id="Other-clusters">
<h3>Other clusters<a class="headerlink" href="#Other-clusters" title="Permalink to this headline">¶</a></h3>
<p>Other clusters can be used by directly passing integer arrays (1 or 2
columns, or a 1-d array) using the input <code class="docutils literal"><span class="pre">clusters</span></code>. This example
clustered by occupation, which is probably not a reliable variable to
cluster on since there are only 9 groups and the usual theory for
clustered standard errors requires that the number of clusters is large.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">clust_entity</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;clustered&#39;</span><span class="p">,</span> <span class="n">clusters</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">occupation</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">occupation</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">clust_entity</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5    934
6    881
9    509
4    486
1    453
7    401
2    399
3    233
8     64
Name: occupation, dtype: int64
                          PooledOLS Estimation Summary
================================================================================
Dep. Variable:                  lwage   R-squared:                        0.1866
Estimator:                  PooledOLS   R-squared (Between):              0.2027
No. Observations:                4360   R-squared (Within):               0.1679
Date:                Sun, Aug 06 2017   R-squared (Overall):              0.1866
Time:                        16:04:21   Log-likelihood                   -2989.2
Cov. Estimator:             Clustered
                                        F-statistic:                      142.61
Entities:                         545   P-value                           0.0000
Avg Obs:                       8.0000   Distribution:                  F(7,4352)
Min Obs:                       8.0000
Max Obs:                       8.0000   F-statistic (robust):             116.58
                                        P-value                           0.0000
Time periods:                       8   Distribution:                  F(7,4352)
Avg Obs:                       545.00
Min Obs:                       545.00
Max Obs:                       545.00

                             Parameter Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
const         -0.0347     0.1479    -0.2346     0.8145     -0.3247      0.2553
black         -0.1438     0.0297    -4.8469     0.0000     -0.2020     -0.0857
hisp           0.0157     0.0266     0.5892     0.5557     -0.0365      0.0679
exper          0.0892     0.0134     6.6513     0.0000      0.0629      0.1155
expersq       -0.0028     0.0009    -3.2442     0.0012     -0.0046     -0.0011
married        0.1077     0.0139     7.7322     0.0000      0.0804      0.1350
educ           0.0994     0.0112     8.8846     0.0000      0.0775      0.1213
union          0.1801     0.0320     5.6323     0.0000      0.1174      0.2428
==============================================================================
</pre></div></div>
</div>
</div>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="data-formats.html" title="previous chapter (use the left arrow)">Data Formats for Panel Data Analysis</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="using-formulas.html" title="next chapter (use the right arrow)">Using formulas to specify models</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="using-formulas.html" title="Using formulas to specify models"
             >next</a> |</li>
        <li class="right" >
          <a href="data-formats.html" title="Data Formats for Panel Data Analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">linearmodels 3.5+13.ga8e016a documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Panel Data Model Estimation</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2017, Kevin Sheppard. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>