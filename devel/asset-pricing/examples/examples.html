

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Examples &#8212; linearmodels 3.5+14.gf04346f documentation</title>
    <link rel="stylesheet" href="../../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.5+14.gf04346f',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using Formulas" href="formulas.html" />
    <link rel="prev" title="Introduction" href="../introduction.html" />
  
  
   

  <link rel="stylesheet" href="../../_static/css/overrides.css" type="text/css" />

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="formulas.html" title="Using Formulas"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../introduction.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">linearmodels 3.5+14.gf04346f documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Linear Factor Models for Asset Pricing</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
        <a href="
    ../../index.html" class="text-logo">linearmodels 3.5 (+14, gf04346f)</a>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../iv/index.html">Instrumental Variable Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../panel/index.html">Panel Data Model Estimation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Linear Factor Models for Asset Pricing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="formulas.html">Using Formulas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference.html">Module Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mathematical-formula.html">Formulas and Mathematical Detail</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../system/index.html">System Regression Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../utility.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plan.html">Module Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

    
  </div>
</div>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../../index.html">Docs</a></li>
              
                <li><a href="../index.html">Linear Factor Models for Asset Pricing</a></li>
              
              <li>Examples</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="section" id="Examples">
<h1>Examples<a class="headerlink" href="#Examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="General-Setup">
<h2>General Setup<a class="headerlink" href="#General-Setup" title="Permalink to this headline">¶</a></h2>
<p>Models include factors and returns. Factors can be traded or non-traded.
Common examples of traded assets include the excess return on the market
and the size and value factors. Examples of non-traded assets include
macroeconomic shocks and measures of uncertainty.</p>
<p>Models are tested using a set of test portfolios. Test portfolios are
often excess returns although they do not need to be.</p>
</div>
<div class="section" id="Import-data">
<h2>Import data<a class="headerlink" href="#Import-data" title="Permalink to this headline">¶</a></h2>
<p>The data used comes from Ken French’s
<a class="reference external" href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">website</a>
and includes 4 factor returns, the excess market, the size factor, the
value factor and the momentum factor. The available test portfolios
include the 12 industry portfolios, a subset of the size-value two way
sort, and a subset of the size-momentum two way sort.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.datasets</span> <span class="kn">import</span> <span class="n">french</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">french</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">french</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Data from Ken French&#39;s data library
http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html

dates    Year and Month of Return
MktRF    Market Factor
SMB      Size Factor
HML      Value Factor
Mom      Momentum Factor
RF       Risk-free rate
NoDur    Industry: Non-durables
Durbl    Industry: Durables
Manuf    Industry: Manufacturing
Enrgy    Industry: Energy
Chems    Industry: Chemicals
BusEq    Industry: Business Equipment
Telcm    Industry: Telecoms
Utils    Industry: Utilities
Shops    Industry: Retail
Hlth     Industry: Health care
Money    Industry: Finance
Other    Industry: Other
S1V1     Small firms, low value
S1V3     Small firms, medium value
S1V5     Small firms, high value
S3V1     Size 3, value 1
S3V3     Size 3, value 3
S3V5     Size 3, value 5
S5V1     Large firms, Low value
S5V3     Large firms, medium value
S5V5     Large Firms, High value
S1M1     Small firms, losers
S1M3     Small firms, neutral
S1M5     Small firms, winners
S3M1     Size 3, momentum 1
S3M3     Size 3, momentum 3
S3M5     Size 3, momentum 5
S5M1     Large firms, losers
S5M3     Large firms, neutral
S5M5     Large firms, winners

</pre></div></div>
</div>
</div>
<div class="section" id="Transform-the-portfolios-to-be-excesses">
<h2>Transform the portfolios to be excesses<a class="headerlink" href="#Transform-the-portfolios-to-be-excesses" title="Permalink to this headline">¶</a></h2>
<p>Subtract the risk-free rate from the test portfolios since these are not
zero-investment.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">:]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">6</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;RF&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="1-Step-Estimation-using-Seemingly-Unrelated-Regression-(SUR)">
<h2>1-Step Estimation using Seemingly Unrelated Regression (SUR)<a class="headerlink" href="#1-Step-Estimation-using-Seemingly-Unrelated-Regression-(SUR)" title="Permalink to this headline">¶</a></h2>
<p>When the factors are traded assets, they must price themselves, and so
the observed factor returns can be used to consistently estimate the
expected factor returns. This also allows a set of seemingly unrelated
regressions where each test portfolio is regressed on the factors and a
constant to estimate factor loadings and <span class="math">\(\alpha\)</span>s.</p>
<p>Note that when using this type of model, it is essential that the test
portfolios are excess returns. This isn’t a requirement of the other
factor model estimators.</p>
<p>This specification is a CAP-M since only the market is included. The
J-statistic tests whether all model <span class="math">\(\alpha\)</span>s are 0. The CAP-M
is unsurprisingly unable to price the test portfolios.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.asset_pricing</span> <span class="kn">import</span> <span class="n">TradedFactorModel</span>
<span class="n">portfolios</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;S1V1&#39;</span><span class="p">,</span><span class="s1">&#39;S1V3&#39;</span><span class="p">,</span><span class="s1">&#39;S1V5&#39;</span><span class="p">,</span><span class="s1">&#39;S3V1&#39;</span><span class="p">,</span><span class="s1">&#39;S3V3&#39;</span><span class="p">,</span><span class="s1">&#39;S3V5&#39;</span><span class="p">,</span><span class="s1">&#39;S5V1&#39;</span><span class="p">,</span><span class="s1">&#39;S5V3&#39;</span><span class="p">,</span><span class="s1">&#39;S5V5&#39;</span><span class="p">]]</span>
<span class="n">factors</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;MktRF&#39;</span><span class="p">]]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">TradedFactorModel</span><span class="p">(</span><span class="n">portfolios</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      TradedFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.6910
No. Factors:                          1   J-statistic:                    70.034
No. Observations:                   819   P-value                         0.0000
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(9)
Time:                          16:17:07
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0065     0.0015     4.3553     0.0000      0.0035      0.0094
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
<p>The factor set is expanded to include both the size and the value
factors.</p>
<p>While the extra factors lower the J statistic and increases the
<span class="math">\(R^2\)</span>, the model is still easily rejected.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">factors</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;MktRF&#39;</span><span class="p">,</span> <span class="s1">&#39;SMB&#39;</span><span class="p">,</span> <span class="s1">&#39;HML&#39;</span><span class="p">]]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">TradedFactorModel</span><span class="p">(</span><span class="n">portfolios</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      TradedFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.8971
No. Factors:                          3   J-statistic:                    53.271
No. Observations:                   819   P-value                         0.0000
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(9)
Time:                          16:17:07
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0065     0.0015     4.3553     0.0000      0.0035      0.0094
SMB            0.0016     0.0010     1.6021     0.1091     -0.0004      0.0035
HML            0.0035     0.0009     3.6993     0.0002      0.0016      0.0053
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
<p>Changing the test portfolios to include only the industry portfolios
does not allow factors to price the assets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">indu</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NoDur&#39;</span><span class="p">,</span> <span class="s1">&#39;Durbl&#39;</span><span class="p">,</span> <span class="s1">&#39;Manuf&#39;</span><span class="p">,</span> <span class="s1">&#39;Enrgy&#39;</span><span class="p">,</span> <span class="s1">&#39;Chems&#39;</span><span class="p">,</span> <span class="s1">&#39;BusEq&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Telcm&#39;</span><span class="p">,</span> <span class="s1">&#39;Utils&#39;</span><span class="p">,</span> <span class="s1">&#39;Shops&#39;</span><span class="p">,</span>  <span class="s1">&#39;Hlth&#39;</span><span class="p">,</span> <span class="s1">&#39;Money&#39;</span><span class="p">,</span>  <span class="s1">&#39;Other&#39;</span><span class="p">]</span>
<span class="n">portfolios</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">indu</span><span class="p">]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">TradedFactorModel</span><span class="p">(</span><span class="n">portfolios</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      TradedFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                 12   R-squared:                      0.7118
No. Factors:                          3   J-statistic:                    61.617
No. Observations:                   819   P-value                         0.0000
Date:                  Mon, Sep 04 2017   Distribution:                 chi2(12)
Time:                          16:17:07
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0065     0.0015     4.3553     0.0000      0.0035      0.0094
SMB            0.0016     0.0010     1.6021     0.1091     -0.0004      0.0035
HML            0.0035     0.0009     3.6993     0.0002      0.0016      0.0053
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
<p>The estimated factor loadings (<span class="math">\(\beta\)</span>s) can be displayed using
the <code class="docutils literal"><span class="pre">betas</span></code> property. There is reasonable dispersion in the factor
loadings for all of the factors, except possibly the market which are
all close to unity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">betas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          MktRF       SMB       HML
NoDur  0.803334 -0.029383  0.080556
Durbl  1.176659  0.104124  0.466510
Manuf  1.129601  0.094600  0.197135
Enrgy  0.913425 -0.234012  0.264609
Chems  0.970844 -0.179466  0.092021
BusEq  1.152119  0.182299 -0.543462
Telcm  0.782811 -0.158395  0.044042
Utils  0.605203 -0.175549  0.260051
Shops  0.942997  0.135802 -0.010064
Hlth   0.864135 -0.213336 -0.315180
Money  1.112368 -0.053364  0.378365
Other  1.109851  0.304442  0.237830
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">betas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[7]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x2b5b53ecf3c8&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/asset-pricing_examples_examples_14_1.png" src="../../_images/asset-pricing_examples_examples_14_1.png" />
</div>
</div>
<p>Similarly the <span class="math">\(\alpha\)</span>s can be displayed. These are monthly
returns, and so scaling by 12 shows annualized returns. Healthcare has
the largest pricing error.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="mi">12</span> <span class="o">*</span> <span class="n">res</span><span class="o">.</span><span class="n">alphas</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="output_area highlight-none"><div class="highlight"><pre>
<span></span>NoDur    0.023360
Durbl   -0.030919
Manuf   -0.010643
Enrgy    0.012009
Chems    0.002783
BusEq    0.024215
Telcm    0.009726
Utils    0.017078
Shops    0.009952
Hlth     0.050760
Money   -0.015197
Other   -0.033345
Name: alpha, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="section" id="2-Step-Estimation">
<h2>2-Step Estimation<a class="headerlink" href="#2-Step-Estimation" title="Permalink to this headline">¶</a></h2>
<p>When one of more factors are not returns on traded assets, it is
necessary to use a two-step procedure (or GMM). In the 2-step estimator,
the first estimates factor loadings and the second uses the factor
loadings to estimate the risk premia.</p>
<p>Here all four factors are used to attempt to price the size-momentum
portfolios.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.asset_pricing</span> <span class="kn">import</span> <span class="n">LinearFactorModel</span>
<span class="n">factors</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;MktRF&#39;</span><span class="p">,</span> <span class="s1">&#39;SMB&#39;</span><span class="p">,</span> <span class="s1">&#39;HML&#39;</span><span class="p">,</span> <span class="s1">&#39;Mom&#39;</span><span class="p">]]</span>
<span class="n">portfolios</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;S1M1&#39;</span><span class="p">,</span><span class="s1">&#39;S1M3&#39;</span><span class="p">,</span><span class="s1">&#39;S1M5&#39;</span><span class="p">,</span><span class="s1">&#39;S3M1&#39;</span><span class="p">,</span><span class="s1">&#39;S3M3&#39;</span><span class="p">,</span><span class="s1">&#39;S3M5&#39;</span><span class="p">,</span><span class="s1">&#39;S5M1&#39;</span><span class="p">,</span><span class="s1">&#39;S5M3&#39;</span><span class="p">,</span><span class="s1">&#39;S5M5&#39;</span><span class="p">]]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">LinearFactorModel</span><span class="p">(</span><span class="n">portfolios</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      LinearFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.9051
No. Factors:                          4   J-statistic:                    36.929
No. Observations:                   819   P-value                         0.0000
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(5)
Time:                          16:17:07
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0070     0.0015     4.5385     0.0000      0.0040      0.0100
SMB            0.0005     0.0014     0.3381     0.7353     -0.0023      0.0033
HML            0.0084     0.0025     3.3085     0.0009      0.0034      0.0133
Mom            0.0084     0.0014     5.8072     0.0000      0.0056      0.0112
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">betas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
         MktRF       SMB       HML       Mom
S1M1  1.092658  1.224223  0.244844 -0.691191
S1M3  0.874285  0.881880  0.459326 -0.082546
S1M5  1.047256  1.147949  0.239957  0.297941
S3M1  1.156849  0.623684  0.059730 -0.760059
S3M3  0.948556  0.467783  0.333619 -0.135465
S3M5  1.128861  0.713403  0.051098  0.413705
S5M1  1.138597 -0.112936 -0.062397 -0.755032
S5M3  0.946214 -0.200052  0.095270 -0.100067
S5M5  1.078098 -0.046531 -0.069780  0.467172
</pre></div></div>
</div>
<p>The identification requirements for this model are the the
<span class="math">\(\beta\)</span>s have unique variation – this requires some
cross-sectional differences in exposures and that the loadings are not
excessively correlated. Since these test portfolios do not attempt to
sort on value, it is relatively non-dispersed and also correlated with
both the market and size. This might make the inference unreliable.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">betas</span><span class="o">.</span><span class="n">corr</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
          MktRF       SMB       HML       Mom
MktRF  1.000000 -0.001914 -0.733916 -0.253675
SMB   -0.001914  1.000000  0.638056 -0.015628
HML   -0.733916  0.638056  1.000000  0.002744
Mom   -0.253675 -0.015628  0.002744  1.000000
</pre></div></div>
</div>
<p>The size factor was insignificant and so is dropped. This doesn’t have
much of an effect on the estimates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.asset_pricing</span> <span class="kn">import</span> <span class="n">LinearFactorModel</span>
<span class="n">factors</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;MktRF&#39;</span><span class="p">,</span> <span class="s1">&#39;HML&#39;</span><span class="p">,</span> <span class="s1">&#39;Mom&#39;</span><span class="p">]]</span>
<span class="n">portfolios</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;S1M1&#39;</span><span class="p">,</span><span class="s1">&#39;S1M3&#39;</span><span class="p">,</span><span class="s1">&#39;S1M5&#39;</span><span class="p">,</span><span class="s1">&#39;S3M1&#39;</span><span class="p">,</span><span class="s1">&#39;S3M3&#39;</span><span class="p">,</span><span class="s1">&#39;S3M5&#39;</span><span class="p">,</span><span class="s1">&#39;S5M1&#39;</span><span class="p">,</span><span class="s1">&#39;S5M3&#39;</span><span class="p">,</span><span class="s1">&#39;S5M5&#39;</span><span class="p">]]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">LinearFactorModel</span><span class="p">(</span><span class="n">portfolios</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      LinearFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7915
No. Factors:                          3   J-statistic:                    36.406
No. Observations:                   819   P-value                         0.0000
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(6)
Time:                          16:17:07
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0073     0.0017     4.3856     0.0000      0.0040      0.0105
HML            0.0091     0.0027     3.4361     0.0006      0.0039      0.0143
Mom            0.0084     0.0015     5.7507     0.0000      0.0055      0.0113
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
<p>The risk-free rate can be optionally estimated. This is useful in case
excess returns are not available of if the risk-free rate used to
construct the excess returns might be mis-specified.</p>
<p>Here the estimated risk-free rate is small and insignificant and has
little impact on the model J-statistic.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.asset_pricing</span> <span class="kn">import</span> <span class="n">LinearFactorModel</span>
<span class="n">factors</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;MktRF&#39;</span><span class="p">,</span> <span class="s1">&#39;HML&#39;</span><span class="p">,</span> <span class="s1">&#39;Mom&#39;</span><span class="p">]]</span>
<span class="n">portfolios</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;S1M1&#39;</span><span class="p">,</span><span class="s1">&#39;S1M3&#39;</span><span class="p">,</span><span class="s1">&#39;S1M5&#39;</span><span class="p">,</span><span class="s1">&#39;S3M1&#39;</span><span class="p">,</span><span class="s1">&#39;S3M3&#39;</span><span class="p">,</span><span class="s1">&#39;S3M5&#39;</span><span class="p">,</span><span class="s1">&#39;S5M1&#39;</span><span class="p">,</span><span class="s1">&#39;S5M3&#39;</span><span class="p">,</span><span class="s1">&#39;S5M5&#39;</span><span class="p">]]</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">LinearFactorModel</span><span class="p">(</span><span class="n">portfolios</span><span class="p">,</span> <span class="n">factors</span><span class="p">,</span> <span class="n">risk_free</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      LinearFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7915
No. Factors:                          3   J-statistic:                    36.020
No. Observations:                   819   P-value                         0.0000
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(5)
Time:                          16:17:07
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
risk_free     -0.0045     0.0079    -0.5607     0.5750     -0.0200      0.0111
MktRF          0.0111     0.0076     1.4636     0.1433     -0.0038      0.0259
HML            0.0110     0.0053     2.0946     0.0362      0.0007      0.0214
Mom            0.0086     0.0014     5.9315     0.0000      0.0058      0.0114
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
<p>The default covariance estimator allows for heteroskedasticity but
assumes there is no autocorrelation in the model errors or factor
returns. Kernel-based HAC estimators (e.g. Newey-West) can be used by
setting <code class="docutils literal"><span class="pre">cov_type='kernel'</span></code>.</p>
<p>This reduces the J-statistic indicating there might be some serial
correlation although the model is still firmly rejected.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">LinearFactorModel</span><span class="p">(</span><span class="n">portfolios</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;kernel&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      LinearFactorModel Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7915
No. Factors:                          3   J-statistic:                    25.841
No. Observations:                   819   P-value                         0.0002
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(6)
Time:                          16:17:07
Cov. Estimator:                  kernel

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0073     0.0017     4.3094     0.0000      0.0040      0.0106
HML            0.0091     0.0031     2.9499     0.0032      0.0031      0.0152
Mom            0.0084     0.0014     5.8371     0.0000      0.0056      0.0112
==============================================================================

Covariance estimator:
KernelCovariance, Kernel: bartlett, Bandwidth: 12
See full_summary for complete results
</pre></div></div>
</div>
</div>
<div class="section" id="GMM-Estimation">
<h2>GMM Estimation<a class="headerlink" href="#GMM-Estimation" title="Permalink to this headline">¶</a></h2>
<p>The final estimator is the GMM estimator which is similar to estimating
the 2-step model in a single step. In practice the GMM estimator is
estimated at least twice, once to get an consistent estimate of the
covariance of the moment conditions and the second time to efficiently
estimate parameters.</p>
<p>The GMM estimator does not have a closed form and so a non-linear
optimizer is required. The default output prints the progress every 10
iterations. Here the model is fit twice, which is the standard method to
implement efficient GMM.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">linearmodels.asset_pricing</span> <span class="kn">import</span> <span class="n">LinearFactorModelGMM</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">LinearFactorModelGMM</span><span class="p">(</span><span class="n">portfolios</span><span class="p">,</span> <span class="n">factors</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Iteration: 0, Objective: 47.75791582813819
Iteration: 10, Objective: 28.102588244953697
Iteration: 20, Objective: 26.361386619983573
Iteration: 30, Objective: 26.019667591312725
Iteration: 40, Objective: 22.32534325297877
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.325343
         Iterations: 41
         Function evaluations: 3581
         Gradient evaluations: 102
Iteration: 0, Objective: 22.51935030426157
Iteration: 10, Objective: 22.303730271566273
Iteration: 20, Objective: 22.226426823839727
Iteration: 30, Objective: 22.19308572609357
Optimization terminated successfully.
         Current function value: 22.066871
         Iterations: 40
         Function evaluations: 1960
         Gradient evaluations: 56
                    LinearFactorModelGMM Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7904
No. Factors:                          3   J-statistic:                    22.067
No. Observations:                   819   P-value                         0.0012
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(6)
Time:                          16:17:10
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0067     0.0015     4.4335     0.0000      0.0037      0.0097
HML            0.0135     0.0023     5.8706     0.0000      0.0090      0.0180
Mom            0.0094     0.0014     6.5139     0.0000      0.0066      0.0123
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
<p>Kernel HAC estimators can be used with this estimator as well. Using a
kernel HAC covariance also implies a Kernel HAC weighting matrix
estimator.</p>
<p>Here the GMM estimator along with the HAC estimator indicates that these
factors might be able to price this set of 9 test portfolios. <code class="docutils literal"><span class="pre">disp=0</span></code>
is used to suppress iterative output.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">cov_type</span><span class="o">=</span><span class="s1">&#39;kernel&#39;</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;bartlett&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                    LinearFactorModelGMM Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7901
No. Factors:                          3   J-statistic:                    13.833
No. Observations:                   819   P-value                         0.0316
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(6)
Time:                          16:17:15
Cov. Estimator:                  kernel

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0074     0.0014     5.1450     0.0000      0.0046      0.0102
HML            0.0137     0.0030     4.5918     0.0000      0.0078      0.0195
Mom            0.0078     0.0013     6.0849     0.0000      0.0053      0.0103
==============================================================================

Covariance estimator:
KernelCovariance, Kernel: bartlett, Bandwidth: 20
See full_summary for complete results
</pre></div></div>
</div>
<div class="section" id="Iterating-until-convergence">
<h3>Iterating until convergence<a class="headerlink" href="#Iterating-until-convergence" title="Permalink to this headline">¶</a></h3>
<p>The standard approach is efficient and uses 2-steps. The first
consistently estimates parameters using a sub-optimal weighting matrix,
and the second uses the optimal weighting matrix conditional using the
first stage estimates.</p>
<p>This method can be repeated until convergence, or for a fixed number of
steps using the <code class="docutils literal"><span class="pre">steps</span></code> keyword argument.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Iteration: 0, Objective: 47.75791582813819
Iteration: 25, Objective: 26.280321851196526
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.325343
         Iterations: 41
         Function evaluations: 3581
         Gradient evaluations: 102
Iteration: 0, Objective: 22.51935030426157
Iteration: 25, Objective: 22.222217523865933
Optimization terminated successfully.
         Current function value: 22.066871
         Iterations: 40
         Function evaluations: 1960
         Gradient evaluations: 56
Iteration: 0, Objective: 22.094157059750625
Iteration: 25, Objective: 22.091266613584885
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.089908
         Iterations: 37
         Function evaluations: 3407
         Gradient evaluations: 97
Iteration: 0, Objective: 22.088798287638685
Iteration: 25, Objective: 22.088771425773373
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.088753
         Iterations: 37
         Function evaluations: 2882
         Gradient evaluations: 82
Iteration: 0, Objective: 22.088622386890318
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.088622
         Iterations: 4
         Function evaluations: 1936
         Gradient evaluations: 55
Iteration: 0, Objective: 22.088622310171576
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.088622
         Iterations: 3
         Function evaluations: 2427
         Gradient evaluations: 69
                    LinearFactorModelGMM Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7904
No. Factors:                          3   J-statistic:                    22.089
No. Observations:                   819   P-value                         0.0012
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(6)
Time:                          16:17:24
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0067     0.0015     4.4231     0.0000      0.0037      0.0096
HML            0.0135     0.0023     5.8726     0.0000      0.0090      0.0180
Mom            0.0094     0.0014     6.5017     0.0000      0.0066      0.0123
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
</div>
<div class="section" id="Continuously-Updating-Estimator">
<h3>Continuously Updating Estimator<a class="headerlink" href="#Continuously-Updating-Estimator" title="Permalink to this headline">¶</a></h3>
<p>The Continuously Updating Estimator (CUE) is optionally available using
the flag <code class="docutils literal"><span class="pre">use_cue</span></code>. CUE jointly minimizes the J-statistic as a
function of the moment conditions and the weighting matrix, rather than
iterating between minimizing the J-statistic for a fixed weighting
matrix and updating the weighting matrix.</p>
<p>Here the results are essentially the same as in the iterative approach.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3"><div class="highlight"><pre>
<span></span><span class="n">res</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">use_cue</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Iteration: 0, Objective: 47.75791582813819
Iteration: 10, Objective: 28.102588244953697
Iteration: 20, Objective: 26.361386619983573
Iteration: 30, Objective: 26.019667591312725
Iteration: 40, Objective: 22.32534325297877
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.325343
         Iterations: 41
         Function evaluations: 3581
         Gradient evaluations: 102
Iteration: 0, Objective: 22.524484079618507
Iteration: 10, Objective: 22.386069979552765
Iteration: 20, Objective: 22.33982033973198
Iteration: 30, Objective: 22.308322782504167
Warning: Desired error not necessarily achieved due to precision loss.
         Current function value: 22.077574
         Iterations: 38
         Function evaluations: 4247
         Gradient evaluations: 121
                    LinearFactorModelGMM Estimation Summary
================================================================================
No. Test Portfolios:                  9   R-squared:                      0.7903
No. Factors:                          3   J-statistic:                    22.719
No. Observations:                   819   P-value                         0.0009
Date:                  Mon, Sep 04 2017   Distribution:                  chi2(6)
Time:                          16:17:29
Cov. Estimator:                  robust

                            Risk Premia Estimates
==============================================================================
            Parameter  Std. Err.     T-stat    P-value    Lower CI    Upper CI
------------------------------------------------------------------------------
MktRF          0.0067     0.0015     4.4157     0.0000      0.0037      0.0096
HML            0.0136     0.0023     5.8881     0.0000      0.0090      0.0181
Mom            0.0094     0.0014     6.4984     0.0000      0.0066      0.0123
==============================================================================

Covariance estimator:
HeteroskedasticCovariance
See full_summary for complete results
</pre></div></div>
</div>
</div>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="../introduction.html" title="previous chapter (use the left arrow)">Introduction</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="formulas.html" title="next chapter (use the right arrow)">Using Formulas</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="formulas.html" title="Using Formulas"
             >next</a> |</li>
        <li class="right" >
          <a href="../introduction.html" title="Introduction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">linearmodels 3.5+14.gf04346f documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Linear Factor Models for Asset Pricing</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2017, Kevin Sheppard. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>